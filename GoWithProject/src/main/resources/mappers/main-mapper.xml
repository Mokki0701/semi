<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN " "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="edu.kh.gowith.main.model.mapper.MainMapper">
	
	<select id="popBoardInquiry" resultType="Board">
	
		SELECT 
		    BOARD_TITLE, 
		    MEMBER_NICKNAME, 
		    BOARD_WRITE_DATE, 
		    BOARD_LIKE_COUNT
		FROM 
		    (
		        SELECT 
		            b.BOARD_TITLE, 
		            m.MEMBER_NICKNAME, 
		            b.BOARD_WRITE_DATE, 
		            b.BOARD_LIKE_COUNT,
		            CASE
		                WHEN '#{value}' = 'LIKE' THEN b.BOARD_LIKE_COUNT
		                WHEN '#{value}' = 'COMMENT' THEN b.COMMENT_COUNT
		            END AS SORT_FIELD
		        FROM 
		            BOARD b 
		            JOIN "MEMBER" m ON b.MEMBER_NO = m.MEMBER_NO
		    ) subquery
		ORDER BY 
		    CASE 
		        WHEN '#{value}' = 'LIKE' THEN subquery.BOARD_LIKE_COUNT
		        WHEN '#{value}' = 'COMMENT' THEN subquery.COMMENT_COUNT
		    END ASC 

	
	</select>
	
	
	

</mapper>
